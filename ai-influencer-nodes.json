{
  "nodes": [
    {
      "parameters": {
        "jsCode": "// AI INFLUENCER BLOG POST GENERATOR\n// TODO: Change MAYA.AI to your chosen influencer name\n\nconst insights = $('Format Final Report').first().json;\nconst allPosts = $('Filter Posts & Extract Product Links').all();\n\nconst issueDate = new Date().toISOString().split('T')[0];\nconst weekLabel = insights.top_trends && insights.top_trends[0] ? insights.top_trends.slice(0, 2).join(' & ') : 'Latest Fashion Trends';\n\n// Generate influencer-style intro\nconst intros = [\n  `I've been scanning what your favorite influencers wear, and trust meâ€”this week is ðŸ”¥. ${insights.summary}`,\n  `You know I see trends before they hit your feed. This week? ${insights.summary}`\n];\nconst intro = intros[0];\n\n// Extract products\nconst products = allPosts.slice(0, 5).map((item, i) => ({\n  name: ['Oversized Blazer', 'Metallic Boots', 'Leather Bag'][i] || 'Fashion Item',\n  brand: 'Designer Brand',\n  price: '$89',\n  affiliate_url: item.json.shopping_url || item.json.post_url,\n  influencer_handle: `@${item.json.author}`,\n  image: item.json.image_url\n}));\n\nconst blogPost = {\n  issue_date: issueDate,\n  week_label: weekLabel,\n  title: `Week ${Math.ceil((new Date() - new Date(new Date().getFullYear(), 0, 1)) / 604800000)}: ${weekLabel}`,\n  intro: intro,\n  summary: insights.summary,\n  trends: insights.top_trends || [],\n  products: products,\n  voice_script: `This week's top trends: ${(insights.top_trends || []).slice(0, 3).join(', ')}.`\n};\n\nreturn [{ json: blogPost }];"
      },
      "id": "generate-blog-post",
      "name": "Generate AI Influencer Blog Post",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2000, 500]
    },
    {
      "parameters": {
        "jsCode": "// WRITE BLOG POST TO LOVABLE SITE\nconst fs = require('fs');\nconst path = require('path');\n\nconst blogData = $json;\nconst baseDir = process.cwd();\nconst figmaDir = path.join(baseDir, 'figma-connect-landing');\n\n// Create blog page content (simplified)\nconst pageContent = `// Blog Post: ${blogData.title}\n// Date: ${blogData.issue_date}\n// Generated by n8n AI Influencer Agent\n\nimport React from 'react';\n\nexport default function BlogPost() {\n  return (\n    <div className=\"max-w-4xl mx-auto px-4 py-12\">\n      <h1 className=\"text-4xl font-bold mb-6\">${blogData.title}</h1>\n      <p className=\"text-lg text-purple-600 font-semibold mb-8\">\n        ${blogData.intro}\n      </p>\n      \n      <section className=\"mb-12\">\n        <h2 className=\"text-3xl font-bold mb-6\">This Week's Vibe</h2>\n        <p className=\"text-lg text-gray-700\">${blogData.summary}</p>\n      </section>\n\n      <section className=\"mb-12\">\n        <h2 className=\"text-3xl font-bold mb-6\">Key Trends</h2>\n        <ul className=\"space-y-4\">\n          ${blogData.trends.map(t => `<li className=\"border-l-4 border-purple-500 pl-4\">${t}</li>`).join('\\n          ')}\n        </ul>\n      </section>\n\n      <section className=\"mb-12\">\n        <h2 className=\"text-3xl font-bold mb-6\">Shop the Looks</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          {/* Products here */}\n        </div>\n      </section>\n\n      <div className=\"mt-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-8 text-center text-white\">\n        <h3 className=\"text-2xl font-bold mb-4\">ðŸ’Œ Get This in Your Inbox</h3>\n        <a href=\"/\" className=\"inline-block bg-white text-purple-600 px-8 py-3 rounded-lg font-semibold\">Subscribe Now</a>\n      </div>\n    </div>\n  );\n}\n`;\n\n// Write files\nconst pagesDir = path.join(figmaDir, 'pages', 'blog');\nif (!fs.existsSync(pagesDir)) fs.mkdirSync(pagesDir, { recursive: true });\n\nconst pagePath = path.join(pagesDir, `${blogData.issue_date}.tsx`);\nfs.writeFileSync(pagePath, pageContent, 'utf8');\n\n// Write JSON\nconst publicDir = path.join(figmaDir, 'public', 'blog');\nif (!fs.existsSync(publicDir)) fs.mkdirSync(publicDir, { recursive: true });\n\nconst jsonPath = path.join(publicDir, `${blogData.issue_date}.json`);\nfs.writeFileSync(jsonPath, JSON.stringify(blogData, null, 2), 'utf8');\n\nconsole.log(`âœ… Blog post created: ${pagePath}`);\n\nreturn [{ json: { blog_path: pagePath, json_path: jsonPath, issue_date: blogData.issue_date } }];"
      },
      "id": "write-blog-post",
      "name": "Write Blog Post Files",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2220, 500]
    },
    {
      "parameters": {
        "jsCode": "// GENERATE VOICE CHAT CONTEXT\nconst blogData = $('Generate AI Influencer Blog Post').first().json;\nconst insights = $('Format Final Report').first().json;\n\nconst voiceContext = {\n  updated_at: new Date().toISOString(),\n  week_label: blogData.week_label,\n  issue_date: blogData.issue_date,\n  key_talk_points: [\n    ...blogData.trends.slice(0, 3),\n    `The sentiment this week is ${insights.sentiment}.`,\n    `I analyzed ${insights.posts_analyzed} posts.`\n  ],\n  top_trends: insights.top_trends || [],\n  popular_colors: insights.popular_colors || [],\n  highlight_products: blogData.products.slice(0, 3),\n  voice_script: blogData.voice_script,\n  blog_url: `/blog/${blogData.issue_date}`\n};\n\nreturn [{ json: voiceContext }];"
      },
      "id": "generate-voice-context",
      "name": "Generate Voice Chat Context",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2440, 500]
    },
    {
      "parameters": {
        "jsCode": "// WRITE VOICE CONTEXT FILE\nconst fs = require('fs');\nconst path = require('path');\n\nconst voiceContext = $json;\nconst baseDir = process.cwd();\nconst publicDir = path.join(baseDir, 'figma-connect-landing', 'public');\n\nif (!fs.existsSync(publicDir)) fs.mkdirSync(publicDir, { recursive: true });\n\nconst contextPath = path.join(publicDir, 'ai_influencer_context.json');\nfs.writeFileSync(contextPath, JSON.stringify(voiceContext, null, 2), 'utf8');\n\nconsole.log(`âœ… Voice context updated: ${contextPath}`);\n\nreturn [{ json: { success: true, context_path: contextPath } }];"
      },
      "id": "write-voice-context",
      "name": "Write Voice Context File",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2660, 500]
    }
  ],
  "connections": {
    "Generate AI Influencer Blog Post": {
      "main": [[{ "node": "Write Blog Post Files", "type": "main", "index": 0 }]]
    },
    "Write Blog Post Files": {
      "main": [[{ "node": "Generate Voice Chat Context", "type": "main", "index": 0 }]]
    },
    "Generate Voice Chat Context": {
      "main": [[{ "node": "Write Voice Context File", "type": "main", "index": 0 }]]
    }
  }
}
